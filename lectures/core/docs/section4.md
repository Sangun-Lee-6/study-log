# μ„Ήμ… 4. μ¤ν”„λ§ ν•µμ‹¬ μ›λ¦¬ μ΄ν•΄2 - κ°μ²΄μ§€ν–¥ μ›λ¦¬ μ μ©

# 1. μƒλ΅μ΄ ν• μΈ μ •μ±… κ°λ°

π‘±β€β™‚οΈΒ κΈ°νμ : μ£Όλ¬Έ κΈμ•΅λ‹Ή ν• μΈν•λ” μ •λ¥ (%) ν• μΈμΌλ΅ μ •μ±… λ³€κ²½

- β΄ μ΄μ— `RateDiscountPolicy`λ¥Ό κ°λ°

β…Β ν…μ¤νΈμ—μ„  μ‹¤ν¨ μΌ€μ΄μ¤μ— λ€ν• ν…μ¤νΈλ„ μ¤‘μ”ν•¨

### π“Β μ •λ¦¬

β… λ¬΄μ—‡μ„ κµ¬ν„ν–λ”κ°€?

- μ •λ¥  ν• μΈ μ •μ±… ν΄λμ¤μ™€ κ·Έμ— λ€ν• ν…μ¤νΈ κ°λ°
- `RateDiscountPolicy`, `RateDiscountPolicyTest`

# 2. μƒλ΅μ΄ ν• μΈ μ •μ±… μ μ©κ³Ό λ¬Έμ μ 

### π“Β λ¬Έμ  λ°°κ²½

β…Β ν„μ¬ λ¬Έμ μ 

- ν„μ¬ μ£Όλ¬Έ μ„λΉ„μ¤(`OrderServiceImpl`)λ” ν• μΈ μ •μ±…(`DiscountPolicy`)μ„ μ‚¬μ©ν•¨
- μ •μ•΅ ν• μΈ(`FixDiscountPolicy`)μ—μ„ μ •λ¥  ν• μΈ(`RateDiscountPolicy`)μΌλ΅ λ³€κ²½ μ‹λ„ν•λ©΄, μ£Όλ¬Έ μ„λΉ„μ¤μ μ½”λ“λ¥Ό κ³ μ³μ•Όν•¨
- 1μ¤„ λ³€κ²½μ΄λΌλ„ κ³ μΉκΈ΄ κ³ μ³μ•Όν•¨

π¤–Β `OrderServiceImpl`

```java
public class OrderServiceImpl implements OrderService {
    // private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
    private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
}
```

β…Β μ½”λ“ ν‰κ°€

| μ—­ν• κ³Ό κµ¬ν„μ λ¶„λ¦¬ | β­•οΈ |
| --- | --- |
| λ‹¤ν•μ„± ν™μ© | β­•οΈ |
| OCP, DIP | β |

### β λ¬Έμ μ  1: DIP μ„λ° (μμ΅΄μ„± μ—­μ „ μ›μΉ™)

β…Β DIP

> κ³ μμ¤€ λ¨λ“μ€ μ €μμ¤€ λ¨λ“μ— μμ΅΄ν•λ©΄ μ• λκ³ , λ‘ λ‹¤ μ¶”μƒν™”μ— μμ΅΄ν•΄μ•Ό ν•λ‹¤.
>

β…Β DIP μ„λ° κ·Όκ±°

- ν„μ¬ `OrderServiceImpl`μ€ `DiscountPolicy`λΌλ” μΈν„°νμ΄μ¤(μ¶”μƒν™”) μ— μμ΅΄ν•κ³  μμ
- κ·Έλ¬λ‚ λ‚΄λ¶€ μ½”λ“λ¥Ό λ³΄λ©΄ κµ¬μ²΄ ν΄λμ¤λ„ ν•¨κ» μμ΅΄ν•κ³  μμ
- λ”°λΌμ„ DIP μ„λ°

π’΅Β κ°μ²΄ Aκ°€ κ°μ²΄ Bλ¥Ό μμ΅΄ν•κ³  μλ‹¤

- κ°μ²΄ A μ½”λ“ μ•μ— κ°μ²΄ Bμ— λ€ν• μ •λ³΄κ°€ μλ‹¤
- μ—¬κΈ°μ„  `new FixDiscountPolicy`λΌλ” 1μ¤„μ΄ μμ β†’ `OrderServiceImpl`μ΄ μμ΅΄ν•κ³  μλ” κ²ƒ

### β λ¬Έμ μ  2: OCP μ„λ° (κ°λ°©-νμ‡„ μ›μΉ™)

β…Β OCP

> ν™•μ¥μ—λ” μ—΄λ ¤ μμ–΄μ•Ό ν•κ³ , λ³€κ²½μ—λ” λ‹«ν€ μμ–΄μ•Ό ν•λ‹¤.
>

β…Β OCP μ„λ° κ·Όκ±°

- FixDiscountPolicyλ¥Ό RateDiscountPolicyλ΅ κµμ²΄ν•λ ¤κ³  ν•λ©΄ μ½”λ“λ¥Ό μμ •ν•΄μ•Όν•¨
- `OrderServiceImpl` ν΄λμ¤ μμ²΄λ¥Ό λ³€κ²½
- μ •μ±…μ„ ν™•μ¥ν• κ²ƒ λΏμΈλ°, ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ¥Ό μμ •ν–μΌλ―€λ΅ OCP μ„λ°

### π›  ν•΄κ²° λ°©μ•: ν΄λΌμ΄μ–ΈνΈκ°€ κµ¬ν„μ„ λ°λΌλ„ λλ„λ΅ μ„¤κ³„ λ³€κ²½

1οΈβƒ£ μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ„λ΅ μ½”λ“ λ³€κ²½ (DIP λ§μ΅±)

```java
public class OrderServiceImpl implements OrderService {
    private DiscountPolicy discountPolicy; // μ΄μ  κµ¬ν„μ²΄λ¥Ό μ§μ ‘ μƒμ„±ν•μ§€ μ•μ
}
```

- `OrderServiceImpl`μ€ λ” μ΄μƒ `FixDiscountPolicy`λ‚ `RateDiscountPolicy`μ— μμ΅΄ν•μ§€ μ•μ
- μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ―€λ΅ DIP λ§μ΅±

2οΈβƒ£ ν•μ§€λ§ μ‹¤ν–‰ μ‹ μ¤λ¥ λ°μƒ (NPE)

```java
OrderServiceImpl service = new OrderServiceImpl();
service.createOrder(...); // NullPointerException λ°μƒ!
```

- κµ¬ν„μ²΄κ°€ μ—†μΌλ‹ `discountPolicy`λ” `null` β†’ μ‹¤ν–‰ μ‹ NPE λ°μƒ

### β’οΈ κ¶κ·Ήμ  ν•΄κ²°: **λ„κµ°κ°€κ°€ κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ£Όμ…ν•΄μ•Ό ν•¨**

β…Β μ΄ μ—­ν• μ„ μν–‰ν•λ” κ² λ°”λ΅ AppConfig λλ” μ¤ν”„λ§ μ»¨ν…μ΄λ„

# 3. κ΄€μ‹¬μ‚¬μ λ¶„λ¦¬

### π“Β ν„μ¬ μ½”λ“μ λ¬Έμ 

β…Β ν„μ¬ μ£Όλ¬Έ μ„λΉ„μ¤(OrderServiceImpl) ν΄λΌμ΄μ–ΈνΈλ” μ±…μ„μ΄ μ—¬λ¬ κ°μ„

- μ£Όλ¬Έ μ„λΉ„μ¤μ— λ€ν• λ΅μ§ & κµ¬ν„μ²΄ ν΄λμ¤ κ²°μ • β‡’ μ±…μ„ μ¤‘λ³µ

```java
public class OrderServiceImpl implements OrderService {
    private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
}
```

β…Β ν„μ¬ μ£Όλ¬Έ μ„λΉ„μ¤ ν΄λΌμ΄μ–ΈνΈλ” OCP, DIP μ„λ°

- λ³€κ²½μ΄ λ°μƒν•  λ• ν΄λΌμ΄μ–ΈνΈ ν΄λμ¤λ„ κ°™μ΄ μμ •ν•΄μ•Όν•¨

### β’οΈΒ ν•΄κ²° λ°©μ•: AppConfig λ„μ… β‡’ κ΄€μ‹¬μ‚¬ λ¶„λ¦¬

β…Β `AppConfig`λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ΄ μ™ κ΄€μ‹¬μ‚¬ λ¶„λ¦¬μΈκ°€?

- μ„¤μ • ν΄λμ¤(AppConfig) λ¥Ό μƒλ΅ λ§λ“¤μ–΄ κ°μ²΄ μƒμ„±κ³Ό μ—°κ²°μ„ λ‹΄λ‹Ήν•κ² λ¶„λ¦¬
- κ·Έλ¬λ©΄ κ°μ²΄ μƒμ„±, μ—°κ²°(μ„¤μ • μ±…μ„)κ³Ό κ°μ²΄ μ‚¬μ©(μ‹¤ν–‰ μ±…μ„)μ„ λ¶„λ¦¬ν•λ” κ²ƒ

β…Β `AppCofig`λ” μƒμ„±ν• κ°μ²΄μ μ°Έμ΅°κ°’μ„ μƒμ„±μλ΅ μ£Όμ…ν•΄μ¤

### π“Β κ΄€μ‹¬μ‚¬ λ¶„λ¦¬ β‡’ β΄ ν΄λΌμ΄μ–ΈνΈ μ½”λ“ λ³€κ²½ X

Β 

β…Β κ΄€μ‹¬μ‚¬ λ¶„λ¦¬μ μ¥μ 

- ν΄λΌμ΄μ–ΈνΈλ” λ” μ΄μƒ κµ¬ν„μ²΄λ¥Ό μ§μ ‘ μƒμ„±ν•μ§€ μ•κ³  μ£Όμ…λ μΈν„°νμ΄μ¤λ§ μ‚¬μ©
- ν΄λΌμ΄μ–ΈνΈλ” μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ β†’ DIP μ¶©μ΅±
- ν΄λΌμ΄μ–ΈνΈλ” μ£Όμ…λ§ λ°›κΈ° λ•λ¬Έμ— OCP μ¶©μ΅±

β…Β `MemberServiceImpl`, `OrderServiceImpl`μ€ λ”μ΄μƒ κµ¬ν„ κ°μ²΄μ— μμ΅΄ν•μ§€ μ•μ

- μμ΅΄ κ΄€κ³„μ— λ€ν• κ³ λ―Όμ€ μ™Έλ¶€(AppConfig)μ— λ§΅κΈ°κ³ , ν•΄λ‹Ή μ‹¤ν–‰μ—λ§ μ§‘μ¤‘

![image.png](./img/image3.png)

### β… DI(Dependency Injection)μ μ μ©

- `AppConfig`κ°€ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μμ΅΄κ΄€κ³„λ¥Ό μƒμ„±μλ¥Ό ν†µν•΄ μ£Όμ…ν•¨μΌλ΅μ¨ DI μ‹¤ν„
- DIP μ™„μ„± : `MemberServiceImpl`μ€ μ¶”μƒ ν΄λμ¤(`MemberRepository`)μ—λ§ μμ΅΄ν•λ©΄ λ¨
- κ΄€μ‹¬μ‚¬ λ¶„λ¦¬ : κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ—°κ²°ν•λ” μ—­ν• κ³Ό μ‹¤ν–‰ν•λ” μ—­ν• μ λ¶„λ¦¬

β…Β `MemberApp`, `OrderApp` ν΄λμ¤λ„ κµ¬ν„ ν΄λμ¤μ— μμ΅΄ν•μ§€ μ•κ³  `AppConfig`λ¥Ό ν†µν•΄ DIP μ¶©μ΅±

### π“Β ν…μ¤νΈ μ½”λ“μ—μ„λ„ AppConfig ν™μ©

β…Β `@BeforeEach` ν‚¤μ›λ“λ΅ κ° ν…μ¤νΈλ¥Ό νΈμ¶ν•κΈ° μ „μ— κµ¬ν„μ²΄λ¥Ό μ£Όμ…λ°›μ

### π“Β μ •λ¦¬

β…Β AppConfigλ΅ κ΄€μ‹¬μ‚¬ λ¶„λ¦¬ : κ°μ²΄ μƒμ„±,μ—°κ²° μ±…μ„ β†” μ‹¤ν–‰ μ±…μ„μ„ λ¶„λ¦¬

β…Β AppConfigλ΅ DIP μ¶©μ΅± : μ¶”μƒ ν΄λμ¤μ—λ§ μμ΅΄ν•λ―€λ΅

β…Β AppConfigλ΅ OCP μ¶©μ΅± : μƒλ΅μ΄ κµ¬ν„ ν΄λμ¤λ¥Ό μ¶”κ°€ν•΄λ„ ν΄λΌμ΄μ–ΈνΈ μ½”λ“μ— λ³€κ²½ μ—†μ

# 4. AppConfig λ¦¬ν©ν„°λ§

AppConfigμ—λ” μ¤‘λ³µμ΄ μκ³ , μ—­ν• μ— λ”°λ¥Έ κµ¬ν„μ΄ μ μ•λ³΄μ„?

β†’ μ½”λ“λ΅ μ„¤λ…

λ¦¬ν©ν† λ§ν• μ½”λ“μ μ¥μ 

new MemoryMemberRepository μ¤‘λ³µ μ κ±°

AppConfigμ μ—­ν• κ³Ό κµ¬ν„ ν΄λμ¤κ°€ ν•λμ— λ“¤μ–΄μ΄

λ”°λΌμ„ μ•±μ μ „μ²΄ κµ¬μ„±μ΄ μ–΄λ–»κ² λμ–΄ μλ”μ§€ νμ•… κ°€λ¥

### π“Β λ¬Έμ  μΈμ‹: μ¤‘λ³µκ³Ό λ¶λ…ν™•ν• μ—­ν• -κµ¬ν„ κµ¬λ¶„

β…Β κΈ°μ΅΄ `AppConfig` κµ¬ν„μ—μ„λ” λ‹¤μ λ‘ κ°€μ§€ λ¬Έμ κ°€ μ΅΄μ¬ν•¨

**1.** μ¤‘λ³µλ κ°μ²΄ μƒμ„±

- `new MemoryMemberRepository()`κ°€ μ—¬λ¬ κ³³μ—μ„ λ°λ³µλ¨
- λ™μΌν• κµ¬ν„μ²΄κ°€ μ—¬λ¬ λ² μƒμ„±λκ³ , ν•΄λ‹Ή κµ¬ν„ ν΄λμ¤λ¥Ό λ‹¤λ¥Έ κ²ƒμΌλ΅ κµμ²΄ν•λ ¤λ©΄ μ—¬λ¬ κ³³μ„ μμ •ν•΄μ•Όν•¨

2. μ—­ν• κ³Ό κµ¬ν„μ΄ μ½”λ“ μƒ λ¶„λ¦¬λμ§€ μ•μ

- μ—­ν• (`MemberRepository`, `DiscountPolicy`)κ³Ό κµ¬ν„(`MemoryMemberRepository`, `FixDiscountPolicy`)μ΄ λ…ν™•ν κµ¬λ¶„λμ§€ μ•μ
- `AppConfig`λ¥Ό μ½λ” μ‚¬λμ΄ "μ–΄λ–¤ μ—­ν• μ΄ μ–΄λ–¤ κµ¬ν„μ²΄λ΅ μ—°κ²°λλ”κ°€"λ¥Ό μ§κ΄€μ μΌλ΅ νμ•…ν•κΈ° μ–΄λ ¤μ›€
- μ• ν”λ¦¬μΌ€μ΄μ… μ„¤μ •μ΄ "μ„¤μ • μ—­ν• "λ³΄λ‹¤λ” "μ¦‰μ„ κ°μ²΄ μƒμ„± μ½”λ“"μ— κ°€κΉμ›€

### β’οΈΒ λ¦¬ν©ν„°λ§ λ©μ 

β…Β λ¦¬ν©ν† λ§ ν¨κ³Ό

- μ¤‘λ³µλ μ½”λ“ μ κ±° β†’ μ μ§€λ³΄μμ„± ν–¥μƒ
- μ—­ν• (μΈν„°νμ΄μ¤)κ³Ό κµ¬ν„(ν΄λμ¤)μ λ§¤ν•‘ κµ¬μ΅°λ¥Ό ν•λμ— λ³΄μ΄κ² β†’ μ„¤μ • ν΄λμ¤μ λ…ν™•ν• μ—­ν• 

### π“Β λ¦¬ν©ν„°λ§ μ „ν›„ λΉ„κµ

| ν•­λ© | λ¦¬ν©ν„°λ§ μ „ | λ¦¬ν©ν„°λ§ ν›„ |
| --- | --- | --- |
| μ¤‘λ³µ | `new MemoryMemberRepository()` μ¤‘λ³µ λ°μƒ | `memberRepository()`λ΅ μΌμ›ν™” |
| κµ¬ν„ κµμ²΄ | μ—¬λ¬ μ„μΉ μμ • ν•„μ” | λ‹¨μΌ λ©”μ„λ“ μμ •μΌλ΅ μ „μ²΄ λ°μ |
| μ—­ν• -κµ¬ν„ κµ¬λ¶„ | λ¶λ…ν™• | λ…ν™•: `DiscountPolicy β†’ FixDiscountPolicy` |
| κµ¬μ΅° μ΄ν•΄ | ν΄λμ¤ κ°„ μ—°κ²° νμ•… μ–΄λ ¤μ›€ | μ„¤μ • ν΄λμ¤λ§ λ΄λ„ μ „μ²΄ κµ¬μ΅° νμ•… κ°€λ¥ |

β…Β λ§μ•½ μ •μ±…μ΄ λ³€κ²½λμ–΄ κµ¬ν„ ν΄λμ¤λ¥Ό λ³€κ²½ν•΄μ•Όν•λ‹¤λ©΄ 1μ¤„λ§ μμ •ν•΄μ„ μ •μ±… λ³€κ²½ κ°€λ¥

- OCP(Open-Closed Principle) μ‹¤ν„

# 5. μƒλ΅μ΄ κµ¬μ΅°μ™€ ν• μΈ μ •μ±… μ μ©

### π“ λ³€κ²½ μ‹λ‚λ¦¬μ¤

β…Β μ •μ•΅ ν• μΈ β†’ μ •λ¥  ν• μΈμΌλ΅ λ³€κ²½

- κΈ°μ΅΄ ν• μΈ μ •μ±…: `FixDiscountPolicy` (μ •μ•΅ ν• μΈ)
- μƒλ΅μ΄ μ •μ±…: `RateDiscountPolicy` (μ •λ¥  ν• μΈ)

### π“Β AppConfigλ΅ μ•±μ κ΄€μ‹¬μ‚¬κ°€ λ¶„λ¦¬λ¨

| κµ¬λ¶„ | μ—­ν•  | μμ‹ |
| --- | --- | --- |
| **μ‚¬μ© μμ—­** | μ‹¤μ  λΉ„μ¦λ‹μ¤ λ΅μ§μ„ μν–‰ | `OrderServiceImpl`, `MemberServiceImpl` |
| **κµ¬μ„± μμ—­** | κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ—°κ²° | `AppConfig` |

β…Β ν• μΈ μ •μ±…μ„ λ³€κ²½ν•΄λ„ AppConfigμ μ½”λ“ 1μ¤„λ§ μμ •ν•λ©΄ λ¨

- ν΄λΌμ΄μ–ΈνΈ μ½”λ“(`OrderServiceImpl`)μ€ μ „ν€ μμ •ν•μ§€ μ•μ

### π“Β μ„¤κ³„ μ›μΉ™ μ μ© λ¶„μ„

β…Β DIP β‡’ β­•οΈ

- κµ¬ν„μ΄ μ•„λ‹ μΈν„°νμ΄μ¤μ— μμ΅΄
- `OrderServiceImpl`μ€ `DiscountPolicy` μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ―€λ΅

β…Β OCP β‡’ β­•οΈ

- ν™•μ¥μ—” μ—΄λ ¤μκ³  λ³€κ²½μ—” λ‹«ν€μ•Όν•¨
- κµ¬ν„ κ°μ²΄λ¥Ό `FixDiscountPolicy`μ—μ„ `RateDiscountPolicy`λ΅ λ³€κ²½ν•΄λ„ ν΄λΌμ΄μ–ΈνΈ μ½”λ“(`OrderServiceImpl`)λ” λ³€κ²½ μ—†μ

β…Β κ΄€μ‹¬μ‚¬ λ¶„λ¦¬ β‡’ β­•οΈ

- AppConfigμ—μ„ κ°μ²΄μ μƒμ„±, μ—°κ²° λ‹΄λ‹Ή
- μ„λΉ„μ¤(OrderServiceImpl)λ” κ°μ²΄μ μ‹¤ν–‰μ— μ§‘μ¤‘

# 6. μ „μ²΄ νλ¦„ μ •λ¦¬

### 1οΈβƒ£ μƒλ΅μ΄ ν• μΈ μ •μ±… κ°λ°

- λ‹¤ν•μ„± β‡’ β΄ μƒλ΅μ΄ ν• μΈ μ •μ±… ν΄λμ¤(`RateDiscountPolicy`)λ¥Ό μ‰½κ² μ¶”κ°€ κ°€λ¥
- μΈν„°νμ΄μ¤ κΈ°λ° μ„¤κ³„λ΅ μ½”λ“ ν™•μ¥ κ°€λ¥

---

### 2οΈβƒ£ μƒλ΅μ΄ ν• μΈ μ •μ±… μ μ©κ³Ό λ¬Έμ μ 

- μ •μ±…μ„ μ‹¤μ λ΅ μ μ©ν•λ ¤ ν•λ‹ λ¬Έμ  λ°μƒ : ν΄λΌμ΄μ–ΈνΈ(`OrderServiceImpl`) μ½”λ“λ¥Ό μμ •ν•΄μ•Όν•λ” λ¬Έμ 
- λ¬Έμ μ μ›μΈ : `OrderServiceImpl`μ΄ κµ¬μ²΄ ν΄λμ¤(`FixDiscountPolicy`)μ— μμ΅΄ β‡’ DIP μ„λ°
- μ •μ±…μ„ λ°”κΎΈλ ¤λ©΄ ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ¥Ό μμ •ν•΄μ•Όν•¨ β‡’ OCP μ„λ°

---

### 3οΈβƒ£ κ΄€μ‹¬μ‚¬μ λ¶„λ¦¬

- `OrderServiceImpl`μ—λ” κ°μ²΄μ μƒμ„±κ³Ό μ‹¤ν–‰ μ±…μ„μ΄ μ„μ—¬ μμ—μ
- μ΄λ¥Ό λ¶„λ¦¬ν•κΈ° μ„ν•΄ AppConfig μ‚¬μ©
- AppConfig : κ°μ²΄ μƒμ„±/μ—°κ²°
- ν΄λΌμ΄μ–ΈνΈ : κ°μ²΄ μ‹¤ν–‰

---

### 4οΈβƒ£ AppConfig λ¦¬ν©ν„°λ§

- μ¤‘λ³µ μ κ±°: `new MemoryMemberRepository()` λ“± λ°λ³µ μ κ±°
- μ—­ν• κ³Ό κµ¬ν„μ΄ λ¶„λ…ν•κ² λ“λ¬κ² μμ •
- β΄ λ³€κ²½ μ§€μ μ΄ λ…ν™•ν•΄μ§, μ μ§€λ³΄μ μ©μ΄

---

### 5οΈβƒ£ μƒλ΅μ΄ κµ¬μ΅°μ™€ ν• μΈ μ •μ±… μ μ©

- ν• μΈ μ •μ±…μ„ λ³€κ²½ν•΄λ„ AppConfigλ§ μμ •ν•λ©΄ λ¨
- ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ” κ·Έλ€λ΅ μ μ§€
- DIP, OCP, κ΄€μ‹¬μ‚¬ λ¶„λ¦¬ λ¨λ‘ λ§μ΅±

---

### β… κ²°λ΅ 

| κµ¬λ¶„ | ν•µμ‹¬ λ‚΄μ© |
| --- | --- |
| λ¬Έμ  | ν΄λΌμ΄μ–ΈνΈκ°€ κµ¬μ²΄ κµ¬ν„μ— μμ΅΄ β†’ DIP/OCP μ„λ° |
| ν•΄κ²° | AppConfig λ„μ…μΌλ΅ μƒμ„± μ±…μ„ λ¶„λ¦¬ |
| ν¨κ³Ό | μ‚¬μ© μμ—­μ€ λ³€κ²½ μ—†μ΄ μ μ§€, ν™•μ¥ κ°€λ¥μ„± ν™•λ³΄ |
- μ΄λ” μ¤ν”„λ§μ DI(μμ΅΄κ΄€κ³„ μ£Όμ…) μ² ν•™μ„ μ½”λ“λ΅ κµ¬ν„ν• κΈ°λ° κµ¬μ΅°

# 7. μΆ‹μ€ κ°μ²΄ μ§€ν–¥ μ„¤κ³„μ 5κ°€μ§€ μ›μΉ™ μ μ©

### π“Β κ°μ²΄μ§€ν–¥ μ„¤κ³„ 3λ€ μ›μΉ™ μ •λ¦¬

| μ›μΉ™ | ν•µμ‹¬ μ”μ•½ | μ μ© ν™•μΈ                                                                    |
| --- | --- |--------------------------------------------------------------------------|
| **SRP**(λ‹¨μΌ μ±…μ„ μ›μΉ™) | ν• ν΄λμ¤λ” ν•λ‚μ μ±…μ„λ§ κ°€μ Έμ•Ό ν•¨ | β…Β `OrderServiceImpl` λ“± ν΄λΌμ΄μ–ΈνΈ κ°μ²΄λ” μ‹¤ν–‰λ§ λ‹΄λ‹Ή <br>β…Β `AppConfig`κ°€ κ°μ²΄ μƒμ„±κ³Ό μ—°κ²°μ„ λ‹΄λ‹Ή |
| **DIP**(μμ΅΄κ΄€κ³„ μ—­μ „ μ›μΉ™) | μ¶”μƒν™”μ— μμ΅΄ν•κ³  κµ¬μ²΄ν™”μ— μμ΅΄ν•μ§€ λ§ κ²ƒ | β…Β ν΄λΌμ΄μ–ΈνΈλ” `DiscountPolicy` μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ <br>                                     β…Β `AppConfig`κ°€ κµ¬μ²΄ κ°μ²΄(`FixDiscountPolicy`)λ¥Ό μƒμ„±ν•΄ μ£Όμ… |
| **OCP**(κ°λ°©-νμ‡„ μ›μΉ™) | ν™•μ¥μ—λ” μ—΄λ ¤ μκ³  λ³€κ²½μ—λ” λ‹«ν€ μμ–΄μ•Ό ν•¨ | `Fix β†’ RateDiscountPolicy` λ΅ κΈ°λ¥ ν™•μ¥ ν•  λ• ν΄λΌμ΄μ–ΈνΈ μ½”λ“ μμ • μ—†μ΄ `AppConfig`λ§ λ³€κ²½    |

β…Β κ°μ²΄μ§€ν–¥ μ›μΉ™μ— λ§λ” μ μ—°ν•κ³  ν™•μ¥ κ°€λ¥ν• κµ¬μ΅°

- κ°μ²΄ μƒμ„±κ³Ό μ‹¤ν–‰ μ±…μ„μ„ λ¶„λ¦¬(SRP)
- ν΄λΌμ΄μ–ΈνΈλ” μΈν„°νμ΄μ¤λ§ μμ΅΄(DIP)
- μ •μ±…μ„ λ°”κΏ”λ„ ν΄λΌμ΄μ–ΈνΈλ” λ³€κ²½ μ—†μ(OCP)

# 8. IoC, DI, κ·Έλ¦¬κ³  μ»¨ν…μ΄λ„

### π“Β μ μ–΄μ μ—­μ „ (IoC: Inversion of Control)

β…Β μ „ν†µμ μΈ νλ¦„

- μμ „μ—λ” ν΄λΌμ΄μ–ΈνΈ κ°μ²΄κ°€ μ§μ ‘ ν•„μ”ν• μ„λ²„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ—°κ²°ν•κ³  μ‹¤ν–‰ν–μ
- μ¦‰, ν΄λΌμ΄μ–ΈνΈκ°€ μ „μ²΄ μ μ–΄ νλ¦„μ„ κ°–κ³  μμ

β…Β AppConfig λ“±μ¥ μ΄ν›„

- κ°μ²΄ μƒμ„±κ³Ό μ—°κ²°μ€ AppConfigκ°€ λ‹΄λ‹Ή
- `OrderServiceImpl`μ€ ν•„μ”ν• μΈν„°νμ΄μ¤λ§ νΈμ¶ν•κ³ , μ–΄λ–¤ κµ¬ν„μ²΄κ°€ λ“¤μ–΄μ¬μ§€λ” λ¨λ¦„
- ν”„λ΅κ·Έλ¨μ μ μ–΄ νλ¦„μ΄ μ™Έλ¶€(AppConfig)μ— μν•΄ μ—­μ „λ¨

> π‘‰ μ΄λ¬ν• νλ¦„μ μ „ν™μ„ μ μ–΄μ μ—­μ „(IoC)μ΄λΌκ³  ν•¨
>

β…Β IoC μμ‹

| κµ¬λ¶„ | μ„¤λ… |
| --- | --- |
| κΈ°μ΅΄ κµ¬μ΅° | `OrderServiceImpl`μ΄ `FixDiscountPolicy`λ¥Ό μ§μ ‘ μƒμ„± |
| IoC κµ¬μ΅° | `AppConfig`κ°€ `OrderServiceImpl`κ³Ό `FixDiscountPolicy`λ¥Ό μƒμ„± λ° μ—°κ²° |

---

### π“Β ν”„λ μ„μ›ν¬ vs λΌμ΄λΈλ¬λ¦¬

| κµ¬λ¶„ | μ„¤λ… |
| --- | --- |
| ν”„λ μ„μ›ν¬ | λ‚΄κ°€ μ§  μ½”λ“λ¥Ό ν”„λ μ„μ›ν¬κ°€ μ μ–΄ν•κ³  μ‹¤ν–‰ (μ: JUnit) |
| λΌμ΄λΈλ¬λ¦¬ | λ‚΄κ°€ μ§μ ‘ νΈμ¶ν•μ—¬ μ μ–΄ νλ¦„μ„ λ‚΄κ°€ κ΄€λ¦¬ |

> μ¤ν”„λ§μ€ κ°λ°μκ°€ μ‘μ„±ν• κ°μ²΄λ¥Ό μ»¨ν…μ΄λ„κ°€ μ μ–΄ν•λ―€λ΅ ν”„λ μ„μ›ν¬
>

---

### π“Β μμ΅΄κ΄€κ³„ μ£Όμ… (DI: Dependency Injection)

β…Β ν•µμ‹¬ κ°λ…

- `OrderServiceImpl`μ€ `DiscountPolicy` μΈν„°νμ΄μ¤μ—λ§ μμ΅΄
- μ–΄λ–¤ κµ¬ν„ κ°μ²΄(`Fix` or `Rate`)κ°€ λ“¤μ–΄μ¬μ§€λ” μ™Έλ¶€(AppConfig)κ°€ μ£Όμ…

β…Β ν΄λμ¤ μμ΅΄ vs κ°μ²΄ μμ΅΄

| κµ¬λ¶„ | μ„¤λ… |
| --- | --- |
| μ •μ μΈ ν΄λμ¤ μμ΅΄ κ΄€κ³„ | `import` κµ¬λ¬Έμ„ ν†µν•΄ λ¶„μ„ κ°€λ¥.μ• ν”λ¦¬μΌ€μ΄μ… μ‹¤ν–‰ μ „ νμ•… κ°€λ¥ |
| λ™μ μΈ κ°μ²΄ μμ΅΄ κ΄€κ³„ | μ‹¤ν–‰ μ‹μ (runtime) μ— κ°μ²΄κ°€ μ£Όμ…λμ–΄ μ°Έμ΅° κ΄€κ³„κ°€ κ²°μ •λ¨ |

β…Β μμ‹ : **`OrderServiceImpl.java`**

```java
public class OrderServiceImpl implements OrderService {
    private final DiscountPolicy discountPolicy; // μΈν„°νμ΄μ¤λ§ μμ΅΄
    // μƒμ„±μμ—μ„ μ£Όμ…
}
```

- μ„ μ½”λ“λ” μ •μ μΌλ΅λ” `DiscountPolicy`μ— μμ΅΄ν•μ§€λ§ μ‹¤μ  μ£Όμ…λλ” κ°μ²΄λ” FixDiscountPolicy or RateDiscountPolicy

β…Β DIλ¥Ό μ‚¬μ©ν•λ©΄ μ¥μ 

- ν΄λΌμ΄μ–ΈνΈ μ½”λ“ λ³€κ²½ μ—†μ΄ κµ¬ν„μ²΄λ¥Ό κµμ²΄ κ°€λ¥
- μ •μ  μμ΅΄ κ΄€κ³„λ” μ μ§€ν•λ©΄μ„, λ™μ  κ°μ²΄ μμ΅΄ κ΄€κ³„λ¥Ό μ‰½κ² λ³€κ²½ κ°€λ¥

---

### π“Β IoC μ»¨ν…μ΄λ„ vs DI μ»¨ν…μ΄λ„

| μ©μ–΄ | μ„¤λ… |
| --- | --- |
| **IoC μ»¨ν…μ΄λ„** | κ°μ²΄μ μƒμ„±, κ΄€λ¦¬, μμ΅΄κ΄€κ³„ μ£Όμ…μ„ λ‹΄λ‹Ή |
| **DI μ»¨ν…μ΄λ„** | μμ΅΄κ΄€κ³„ μ£Όμ…μ— μ¤‘μ μ„ λ‘” IoC μ»¨ν…μ΄λ„ |
| κΈ°νƒ€ λ…μΉ­ | μ–΄μ…λΈ”λ¬(Assembler), μ¤λΈμ νΈ ν©ν† λ¦¬ λ“±μΌλ΅λ„ λ¶λ¦Ό |

> μ¤ν”„λ§μ—μ„ λ§ν•λ” μ¤ν”„λ§ μ»¨ν…μ΄λ„ = DI μ»¨ν…μ΄λ„
>
>
> DIλ¥Ό μ¤‘μ‹¬μΌλ΅ κµ¬μ„±λ κ°μ²΄ κ΄€λ¦¬ μ‹μ¤ν…
>

---

### π“Β μ •λ¦¬

β…Β IoC, DI

- μ¤ν”„λ§μ€ κ°μ²΄ μƒμ„±, μ—°κ²°, μ‹¤ν–‰ νλ¦„μ„ ν΄λΌμ΄μ–ΈνΈμ—μ„ μ»¨ν…μ΄λ„(AppConfig λ“±)λ΅ λ„κΉ€ β‡’ μ΄κ²ƒμ΄ `μ μ–΄μ μ—­μ „(IoC)`
- μ΄λ ‡κ² κ°μ²΄λ¥Ό μ™Έλ¶€μ—μ„ λ€μ‹  λ§λ“¤κ³  μ—°κ²°ν•΄μ£Όλ‹κΉ ν•„μ”ν• κ°μ²΄λ¥Ό μ½”λ“ λ‚΄λ¶€μ—μ„ μ§μ ‘ μƒμ„±ν•μ§€ μ•κ³  μ£Όμ… λ°›μ β‡’ μ΄κ²ƒμ΄ `μμ΅΄κ΄€κ³„ μ£Όμ…(DI)`

β…Β IoCμ™€ DIμ κ΄€κ³„

- DIλ” IoCμ κµ¬ν„ λ°©μ‹ μ¤‘ μΌλ¶€

# 9. μ¤ν”„λ§μΌλ΅ μ „ν™ν•κΈ°